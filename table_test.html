<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="static/css/styles.css">
    <style>
        /* Custom styles for the hotel table */
        #hotelTable {
            border-collapse: collapse;
            width: 100%;
            max-width: 400px; /* Adjust the width as needed */
            border: 1px solid #ccc;
            margin-top: 20px; /* Add margin for separation */
        }

        #hotelTable th, #hotelTable td {
            border: 1px solid #ccc;
            padding: 5px;
            text-align: center;
        }

        #hotelTable th {
            background-color: #f2f2f2;
        }

        .chart-container {
      display: flex;
      align-items: center;
      margin-top: 20px;
    }

    .chart-label {
      margin-right: 10px;
    }

    /* Styling for the hotel table */
    #hotelTable {
      width: 100%; /* Make the table full width */
      border-collapse: collapse;
      border: 1px solid #ccc; /* Add border to the table */
      margin-top: 20px; /* Add margin for separation */
    }

    #hotelTable th, #hotelTable td {
      border: 1px solid #ccc; /* Add border to table cells */
      padding: 5px;
      text-align: center;
    }

    #hotelTable {
            border-collapse: collapse;
            width: 100%;
            max-width: 400px; /* Adjust the width as needed */
            border: 1px solid #ccc;
            margin-top: 20px; /* Add margin for separation */
        }

        #hotelTable th, #hotelTable td {
            border: 1px solid #ccc;
            padding: 5px;
            text-align: center;
        }

        #hotelTable th {
            background-color: #f2f2f2;
        }
    </style>

    <title>Travel Guide Dashboard</title>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-12"> <!-- Single Column for Title, City Selection, and Table -->
                <table id="hotelTable">
                    <thead>
                        <tr>
                            <th colspan="4"><h1>Hotel Information</h1></th>
                        </tr>
                        <tr>
                            <th>City Selection</th>
                            <th colspan="3">
                                <label for="citySelect">Select a City:</label>
                                <select id="citySelect">
                                    <option value="">All Cities</option>
                                    <option value="Santa Cruz">Santa Cruz</option>
                                    <option value="Napa">Napa</option>
                                    <option value="American Canyon">American Canyon</option>
                                    <option value="Long Beach">Long Beach</option>
                                    <option value="Fresno">Fresno</option>
                                    <option value="Monterey">Monterey</option>
                                    <option value="Monterey Park">Monterey Park	</option>
                                    <option value="San Luis Obispo">San Luis Obispo</option>
                                    <option value="Gilroy">Gilroy</option>
                                    <option value="Santa Barbara">Santa Barbara</option>
                                    <option value="Palm Springs">Palm Springs</option>
                                    <option value="Sacramento">Sacramento</option>
                                    <option value="West Sacramento">West Sacramento</option>
                                    <option value="Woodland">Woodland</option>
                                    <option value="Anaheim">Anaheim</option>
                                    <option value="Fullerton">Fullerton</option>
                                    <option value="San Diego">San Diego</option>
                                    <option value="Los Angeles">Los Angeles</option>
                                    <option value="San Francisco">San Francisco</option>
                                    <option value="San Luis Obispo">San Luis Obispo</option>
                                    <option value="Pismo Beach">Pismo Beach</option>
                                    <option value="Carmel-By-The-Sea">Carmel-By-The-Sea</option>
                                    <option value="Laguna Beach">Laguna Beach</option>
                                    <option value="Carmel-By-The-Sea">Carmel-By-The-Sea</option>
                                    <option value="Aliso Viejo">Aliso Viejo</option>
                                    <option value="Morro Bay">Morro Bay</option>
                                    <option value="Avalon">Avalon</option>
                                    <option value="Big Bear Lake">Big Bear Lake</option>
                                    <option value="South Pasadena">South Pasadena</option>
                                    <option value="Pasadena">Pasadena</option>
                                    <option value="Carlsbad">Carlsbad</option>
                                    <option value="Fish Camp">Fish Camp</option>
                                    <option value="Ahwahnee">Ahwahnee</option>
                                    <option value="Fountain Valley">Fountain Valley</option>
                                    <option value="Huntington Beach">Huntington Beach</option>
                                    <option value="South Lake Tahoe">South Lake Tahoe</option>
                                    <option value="Mesquite">Mesquite</option>
                                    <option value="Eureka">Eureka</option>
                                    <option value="Bakersfield">Bakersfield</option>
                                    <option value="Oceanside">Oceanside</option>

                                </select>
                            </th>
                        </tr>
                        <tr>
                            <th>Hotel Name</th>
                            <th>City</th>
                            <th>Price</th>
                            <th>Guest Rating</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Hotel data will be populated here -->
                    </tbody>
                </table>
            </table>
            <canvas id="chart"></canvas>
            <canvas id="priceChart"></canvas>
            <canvas id="bubbleChart"></canvas>
            </div>
            /div>
        <div class ="chartBox">
          <canvas id="bar-chart" width = "300px" height="150px"></canvas>
          <button onclick="getData()">Get Hotel Data </button>
          <canvas id="bubble-chart" width = "50px" height="30px"></canvas>
          <button onclick="getData()">Get Hotel Data </button>
          
      </div>
        </div>
    </div>
    <title>Hotel Prices Table</title>
    <div class="col-md-12"> <!-- Single Column for Title, City Selection, and Table -->
        <table id="hotelTable">
            <label for="priceFilter">Select a maximum price: </label>
  <input type="number" id="priceFilter" min="0">
  <button onclick="filterHotels()">Filter Hotels</button>

  <!-- Place the chart and label in a container for styling -->
        <div class="chart-container">
            <label class="chart-label" for="priceChart"></label>
            <canvas id="priceChart"></canvas>
        <canvas id="ratingChart"></canvas>
        <table id="hotelTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>City</th>
                <th>State</th>
                <th>Price</th>
                <th>Rating</th>
              </tr>
            </thead>
            <tbody id="hotelTableBody">
            </tbody>
          </table>       
    
    
    </table>
            
            
    
    
    <script src="hotel_table.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js"></script>
    <script>
        let jsonData = []; // Declare an empty array for the data
        let priceChart = null; // Store the chart instance
    
        // Fetch the JSON data
        fetch('data/hotel_final.json')
          .then(response => response.json())
          .then(data => {
            jsonData = data;
          })
          .catch(error => console.error("Error fetching data:", error));
    
        function filterHotels() {
          const maxPrice = parseFloat(document.getElementById("priceFilter").value);
          const filteredHotels = [];
    
          for (const hotel of jsonData) {
            const hotelPrice = parseFloat(hotel.price);
            if (hotelPrice <= maxPrice) {
              filteredHotels.push(hotel);
            }
          }
    
          populateTable(filteredHotels);
          updatePriceChart(filteredHotels);
        }
    
        function populateTable(filteredHotels) {
          const tableBody = document.getElementById("hotelTableBody");
          tableBody.innerHTML = "";
    
          for (const hotel of filteredHotels) {
            const row = document.createElement("tr");
            row.innerHTML = `
              <td>${hotel.name}</td>
              <td>${hotel.city}</td>
              <td>${hotel.state}</td>
              <td>${hotel.price}</td>
              <td>${hotel.guestrating}</td>
            `;
            tableBody.appendChild(row);
          }
        }
    
        function updatePriceChart(filteredHotels) {
          if (priceChart) {
            priceChart.destroy(); // Destroy the existing chart
          }
    
          const ctx = document.getElementById("priceChart").getContext("2d");
    
          const hotelNames = filteredHotels.map(hotel => hotel.name);
          const hotelPrices = filteredHotels.map(hotel => parseFloat(hotel.price));
    
          priceChart = new Chart(ctx, {
            type: "bar",
            data: {
              labels: hotelNames,
              datasets: [
                {
                  label: "Price",
                  data: hotelPrices,
                  backgroundColor: "rgba(75, 192, 192, 0.2)",
                  borderColor: "rgba(75, 192, 192, 1)",
                  borderWidth: 1
                }
              ]
            },
            options: {
              scales: {
                y: {
                  beginAtZero: true
                }
              }
            }
          });
        }
      </script>
      <script>
        // fetch/get data block
        
            getData();
            
            async function getData() {
                const response = await fetch('https://api.json-generator.com/templates/eAX6PQ7qD8mW/data?access_token=68rhjxsz1p2xylbr8oqpqnl06cdcvmghz3318giq');
                console.log(response);
                const data = await response.json();
                console.log(data);
                length = data.length;
                console.log(length);
                
              
                
                
    
                labels = [];
                values = [];
                names = [];
                lat=[];
                lon=[];
                globalscore=[];
                guestrating=[];
                for (i = 0; i < length; i++) {
                    labels.push(data[i].city);
                    names.push(data[i].name);
                    values.push(data[i].price);
                    lat.push(data[i].lat);
                    lon.push(data[i].lon);
                    globalscore.push(data[i].globalScore);
                    guestrating.push(data[i].guestrating);
                  
                }
                console.log(lat);
                console.log(lon);
            
                const myChart = new Chart(document.getElementById("bar-chart"), {
                  type: 'bar',
                    data: {
                        labels: names,
                        datasets: [
                            {
                                label: "Average guest ratings",
                                data: guestrating,
                                backgroundColor: 'rgb(255, 99, 132, 1)',
                                borderColor: 'rgb(255, 206, 86, 1)',
                                hoverBackgroundColor: 'rgb(255, 99, 132)',
                                borderWidth: 2
                                
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: {
                                ticks: {
                                  labels
                                }
                              },
                            y:{
                                beginAtZero: true
                            }
                        },
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'Hotels Average Guest Ratings'
                        }
                    }
                });
                var dataBubbles = [];
                for (var i = 0; i < lat.length; i++) {
                      dataBubbles.push({
                      x: lat[i],
                      y: lon[i],
                      r: values[i] /12
                  });
                }
              const myChart2 = new Chart(document.getElementById('bubble-chart'), {
                type: 'bubble',
                  data : {
                    labels: labels,
                    datasets: [
                      {
                          label: 'Prices per room by location: $',
                          data: dataBubbles,
                          backgroundColor: 'rgb(255, 99, 132)'
                          }]
                      },
                      options: {
                        responsive: true,
                        scales: {
                          x:{
                            type: 'linear',
                            position: 'bottom',
                            beginAtZero: true
                          },
                          y: {
                            beginAtZero: true
                          },
                        },
                        title:{
                          display: true,
                          text: "Hotel Average Price per Room"
                        }
                      }
  
              });   
              }
        
            //
            //console.log(filterresult);
            //}
        
        </script>
</body>
</html>